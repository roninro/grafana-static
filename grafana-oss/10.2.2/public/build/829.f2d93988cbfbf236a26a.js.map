{"version":3,"file":"829.f2d93988cbfbf236a26a.js","mappings":"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","sources":["webpack://grafana/./.yarn/__virtual__/@grafana-experimental-virtual-4d6787efaa/0/cache/@grafana-experimental-npm-1.7.0-bca9c8fecc-f418072aab.zip/node_modules/@grafana/experimental/dist/esm/QueryEditor/EditorHeader.js","webpack://grafana/./.yarn/__virtual__/@grafana-experimental-virtual-4d6787efaa/0/cache/@grafana-experimental-npm-1.7.0-bca9c8fecc-f418072aab.zip/node_modules/@grafana/experimental/dist/esm/QueryEditor/FlexItem.js","webpack://grafana/./public/app/plugins/datasource/prometheus/querybuilder/shared/OperationInfoButton.tsx","webpack://grafana/./public/app/plugins/datasource/prometheus/querybuilder/shared/OperationHeader.tsx","webpack://grafana/./public/app/plugins/datasource/prometheus/querybuilder/shared/OperationParamEditor.tsx","webpack://grafana/./public/app/plugins/datasource/prometheus/querybuilder/shared/OperationEditor.tsx","webpack://grafana/./public/app/plugins/datasource/prometheus/querybuilder/shared/OperationList.tsx","webpack://grafana/./public/app/plugins/datasource/prometheus/querybuilder/shared/OperationsEditorRow.tsx","webpack://grafana/./public/app/plugins/datasource/prometheus/querybuilder/shared/QueryBuilderHints.tsx","webpack://grafana/./public/app/plugins/datasource/prometheus/querybuilder/shared/QueryEditorModeToggle.tsx","webpack://grafana/./public/app/plugins/datasource/prometheus/querybuilder/shared/QueryHeaderSwitch.tsx","webpack://grafana/./public/app/plugins/datasource/prometheus/querybuilder/shared/QueryOptionGroup.tsx","webpack://grafana/./public/app/plugins/datasource/prometheus/querybuilder/shared/hooks/useFlag.ts"],"sourcesContent":["import { css } from '@emotion/css';\nimport React__default from 'react';\nimport { useStyles2 } from '@grafana/ui';\n\nconst EditorHeader = ({ children }) => {\n  const styles = useStyles2(getStyles);\n  return /* @__PURE__ */ React__default.createElement(\"div\", { className: styles.root }, children);\n};\nconst getStyles = (theme) => ({\n  root: css({\n    display: \"flex\",\n    flexWrap: \"wrap\",\n    alignItems: \"center\",\n    gap: theme.spacing(3),\n    minHeight: theme.spacing(4)\n  })\n});\n\nexport { EditorHeader };\n//# sourceMappingURL=EditorHeader.js.map\n","import React__default from 'react';\n\nconst FlexItem = ({ grow, shrink }) => {\n  return /* @__PURE__ */ React__default.createElement(\"div\", { style: { display: \"block\", flexGrow: grow, flexShrink: shrink } });\n};\n\nexport { FlexItem };\n//# sourceMappingURL=FlexItem.js.map\n","import { css } from '@emotion/css';\nimport React, { useState } from 'react';\nimport { usePopperTooltip } from 'react-popper-tooltip';\n\nimport { GrafanaTheme2, renderMarkdown } from '@grafana/data';\nimport { FlexItem } from '@grafana/experimental';\nimport { Button, Portal, useStyles2 } from '@grafana/ui';\n\nimport { QueryBuilderOperation, QueryBuilderOperationDef } from './types';\n\nexport interface Props {\n  operation: QueryBuilderOperation;\n  def: QueryBuilderOperationDef;\n}\n\nexport const OperationInfoButton = React.memo<Props>(({ def, operation }) => {\n  const styles = useStyles2(getStyles);\n  const [show, setShow] = useState(false);\n  const { getTooltipProps, setTooltipRef, setTriggerRef, visible } = usePopperTooltip({\n    placement: 'top',\n    visible: show,\n    offset: [0, 16],\n    onVisibleChange: setShow,\n    interactive: true,\n    trigger: ['click'],\n  });\n\n  return (\n    <>\n      <Button\n        title=\"Click to show description\"\n        ref={setTriggerRef}\n        icon=\"info-circle\"\n        size=\"sm\"\n        variant=\"secondary\"\n        fill=\"text\"\n      />\n      {visible && (\n        <Portal>\n          <div ref={setTooltipRef} {...getTooltipProps()} className={styles.docBox}>\n            <div className={styles.docBoxHeader}>\n              <span>{def.renderer(operation, def, '<expr>')}</span>\n              <FlexItem grow={1} />\n              <Button\n                icon=\"times\"\n                onClick={() => setShow(false)}\n                fill=\"text\"\n                variant=\"secondary\"\n                title=\"Remove operation\"\n              />\n            </div>\n            <div\n              className={styles.docBoxBody}\n              dangerouslySetInnerHTML={{ __html: getOperationDocs(def, operation) }}\n            ></div>\n          </div>\n        </Portal>\n      )}\n    </>\n  );\n});\n\nOperationInfoButton.displayName = 'OperationDocs';\n\nconst getStyles = (theme: GrafanaTheme2) => {\n  return {\n    docBox: css({\n      overflow: 'hidden',\n      background: theme.colors.background.primary,\n      border: `1px solid ${theme.colors.border.strong}`,\n      boxShadow: theme.shadows.z3,\n      maxWidth: '600px',\n      padding: theme.spacing(1),\n      borderRadius: theme.shape.radius.default,\n      zIndex: theme.zIndex.tooltip,\n    }),\n    docBoxHeader: css({\n      fontSize: theme.typography.h5.fontSize,\n      fontFamily: theme.typography.fontFamilyMonospace,\n      paddingBottom: theme.spacing(1),\n      display: 'flex',\n      alignItems: 'center',\n    }),\n    docBoxBody: css({\n      // The markdown paragraph has a marginBottom this removes it\n      marginBottom: theme.spacing(-1),\n      color: theme.colors.text.secondary,\n    }),\n    signature: css({\n      fontSize: theme.typography.bodySmall.fontSize,\n      fontFamily: theme.typography.fontFamilyMonospace,\n    }),\n    dropdown: css({\n      opacity: 0,\n      color: theme.colors.text.secondary,\n    }),\n  };\n};\nfunction getOperationDocs(def: QueryBuilderOperationDef, op: QueryBuilderOperation): string {\n  return renderMarkdown(def.explainHandler ? def.explainHandler(op, def) : def.documentation ?? 'no docs');\n}\n","import { css } from '@emotion/css';\nimport React, { useState } from 'react';\nimport { DraggableProvided } from 'react-beautiful-dnd';\n\nimport { GrafanaTheme2, SelectableValue } from '@grafana/data';\nimport { FlexItem } from '@grafana/experimental';\nimport { Button, Select, useStyles2 } from '@grafana/ui';\n\nimport { OperationInfoButton } from './OperationInfoButton';\nimport { VisualQueryModeller, QueryBuilderOperation, QueryBuilderOperationDef } from './types';\n\nexport interface Props {\n  operation: QueryBuilderOperation;\n  def: QueryBuilderOperationDef;\n  index: number;\n  queryModeller: VisualQueryModeller;\n  dragHandleProps?: DraggableProvided['dragHandleProps'];\n  onChange: (index: number, update: QueryBuilderOperation) => void;\n  onRemove: (index: number) => void;\n}\n\ninterface State {\n  isOpen?: boolean;\n  alternatives?: Array<SelectableValue<QueryBuilderOperationDef>>;\n}\n\nexport const OperationHeader = React.memo<Props>(\n  ({ operation, def, index, onChange, onRemove, queryModeller, dragHandleProps }) => {\n    const styles = useStyles2(getStyles);\n    const [state, setState] = useState<State>({});\n\n    const onToggleSwitcher = () => {\n      if (state.isOpen) {\n        setState({ ...state, isOpen: false });\n      } else {\n        const alternatives = queryModeller\n          .getAlternativeOperations(def.alternativesKey!)\n          .map((alt) => ({ label: alt.name, value: alt }));\n        setState({ isOpen: true, alternatives });\n      }\n    };\n\n    return (\n      <div className={styles.header}>\n        {!state.isOpen && (\n          <>\n            <div {...dragHandleProps}>{def.name ?? def.id}</div>\n            <FlexItem grow={1} />\n            <div className={`${styles.operationHeaderButtons} operation-header-show-on-hover`}>\n              <Button\n                icon=\"angle-down\"\n                size=\"sm\"\n                onClick={onToggleSwitcher}\n                fill=\"text\"\n                variant=\"secondary\"\n                title=\"Click to view alternative operations\"\n              />\n              <OperationInfoButton def={def} operation={operation} />\n              <Button\n                icon=\"times\"\n                size=\"sm\"\n                onClick={() => onRemove(index)}\n                fill=\"text\"\n                variant=\"secondary\"\n                title=\"Remove operation\"\n              />\n            </div>\n          </>\n        )}\n        {state.isOpen && (\n          <div className={styles.selectWrapper}>\n            <Select\n              autoFocus\n              openMenuOnFocus\n              placeholder=\"Replace with\"\n              options={state.alternatives}\n              isOpen={true}\n              onCloseMenu={onToggleSwitcher}\n              onChange={(value) => {\n                if (value.value) {\n                  // Operation should exist if it is selectable\n                  const newDef = queryModeller.getOperationDef(value.value.id)!;\n\n                  // copy default params, and override with all current params\n                  const newParams = [...newDef.defaultParams];\n                  for (let i = 0; i < Math.min(operation.params.length, newParams.length); i++) {\n                    if (newDef.params[i].type === def.params[i].type) {\n                      newParams[i] = operation.params[i];\n                    }\n                  }\n\n                  const changedOp = { ...operation, params: newParams, id: value.value.id };\n                  onChange(index, def.changeTypeHandler ? def.changeTypeHandler(changedOp, newDef) : changedOp);\n                }\n              }}\n            />\n          </div>\n        )}\n      </div>\n    );\n  }\n);\n\nOperationHeader.displayName = 'OperationHeader';\n\nconst getStyles = (theme: GrafanaTheme2) => {\n  return {\n    header: css({\n      borderBottom: `1px solid ${theme.colors.border.medium}`,\n      padding: theme.spacing(0.5, 0.5, 0.5, 1),\n      display: 'flex',\n      alignItems: 'center',\n    }),\n    operationHeaderButtons: css({\n      opacity: 1,\n    }),\n    selectWrapper: css({\n      paddingRight: theme.spacing(2),\n    }),\n  };\n};\n","import { css } from '@emotion/css';\nimport React, { ComponentType } from 'react';\n\nimport { GrafanaTheme2, SelectableValue, toOption } from '@grafana/data';\nimport { Stack } from '@grafana/experimental';\nimport { AutoSizeInput, Button, Checkbox, Select, useStyles2 } from '@grafana/ui';\n\nimport { QueryBuilderOperationParamDef, QueryBuilderOperationParamEditorProps } from '../shared/types';\n\nimport { getOperationParamId } from './operationUtils';\n\nexport function getOperationParamEditor(\n  paramDef: QueryBuilderOperationParamDef\n): ComponentType<QueryBuilderOperationParamEditorProps> {\n  if (paramDef.editor) {\n    return paramDef.editor;\n  }\n\n  if (paramDef.options) {\n    return SelectInputParamEditor;\n  }\n\n  switch (paramDef.type) {\n    case 'boolean':\n      return BoolInputParamEditor;\n    case 'number':\n    case 'string':\n    default:\n      return SimpleInputParamEditor;\n  }\n}\n\nfunction SimpleInputParamEditor(props: QueryBuilderOperationParamEditorProps) {\n  return (\n    <AutoSizeInput\n      id={getOperationParamId(props.operationId, props.index)}\n      defaultValue={props.value?.toString()}\n      minWidth={props.paramDef.minWidth}\n      placeholder={props.paramDef.placeholder}\n      title={props.paramDef.description}\n      maxWidth={(props.paramDef.minWidth || 20) * 3}\n      onCommitChange={(evt) => {\n        props.onChange(props.index, evt.currentTarget.value);\n        if (props.paramDef.runQueryOnEnter && evt.type === 'keydown') {\n          props.onRunQuery();\n        }\n      }}\n    />\n  );\n}\n\nfunction BoolInputParamEditor(props: QueryBuilderOperationParamEditorProps) {\n  return (\n    <Checkbox\n      id={getOperationParamId(props.operationId, props.index)}\n      value={Boolean(props.value)}\n      onChange={(evt) => props.onChange(props.index, evt.currentTarget.checked)}\n    />\n  );\n}\n\nfunction SelectInputParamEditor({\n  paramDef,\n  value,\n  index,\n  operationId,\n  onChange,\n}: QueryBuilderOperationParamEditorProps) {\n  const styles = useStyles2(getStyles);\n  let selectOptions = paramDef.options as SelectableValue[];\n\n  if (!selectOptions[0]?.label) {\n    selectOptions = paramDef.options!.map((option) => ({\n      label: option.toString(),\n      value: option,\n    }));\n  }\n\n  let valueOption = selectOptions.find((x) => x.value === value) ?? toOption(value as string);\n\n  // If we have optional options param and don't have value, we want to render button with which we add optional options.\n  // This makes it easier to understand what needs to be selected and what is optional.\n  if (!value && paramDef.optional) {\n    return (\n      <div className={styles.optionalParam}>\n        <Button\n          size=\"sm\"\n          variant=\"secondary\"\n          title={`Add ${paramDef.name}`}\n          icon=\"plus\"\n          onClick={() => onChange(index, selectOptions[0].value)}\n        >\n          {paramDef.name}\n        </Button>\n      </div>\n    );\n  }\n\n  return (\n    <Stack gap={0.5} direction=\"row\" alignItems=\"center\" wrap={false}>\n      <Select\n        id={getOperationParamId(operationId, index)}\n        value={valueOption}\n        options={selectOptions}\n        placeholder={paramDef.placeholder}\n        allowCustomValue={true}\n        onChange={(value) => onChange(index, value.value!)}\n        width={paramDef.minWidth || 'auto'}\n      />\n      {paramDef.optional && (\n        <Button\n          data-testid={`operations.${index}.remove-param`}\n          size=\"sm\"\n          fill=\"text\"\n          icon=\"times\"\n          variant=\"secondary\"\n          title={`Remove ${paramDef.name}`}\n          onClick={() => onChange(index, '')}\n        />\n      )}\n    </Stack>\n  );\n}\n\nconst getStyles = (theme: GrafanaTheme2) => {\n  return {\n    optionalParam: css({\n      marginTop: theme.spacing(1),\n    }),\n  };\n};\n","import { css, cx } from '@emotion/css';\nimport React, { useEffect, useId, useState } from 'react';\nimport { Draggable } from 'react-beautiful-dnd';\n\nimport { DataSourceApi, GrafanaTheme2 } from '@grafana/data';\nimport { Stack } from '@grafana/experimental';\nimport { Button, Icon, InlineField, Tooltip, useTheme2 } from '@grafana/ui';\nimport { isConflictingFilter } from 'app/plugins/datasource/loki/querybuilder/operationUtils';\nimport { LokiOperationId } from 'app/plugins/datasource/loki/querybuilder/types';\n\nimport { OperationHeader } from './OperationHeader';\nimport { getOperationParamEditor } from './OperationParamEditor';\nimport { getOperationParamId } from './operationUtils';\nimport {\n  QueryBuilderOperation,\n  QueryBuilderOperationDef,\n  QueryBuilderOperationParamDef,\n  QueryBuilderOperationParamValue,\n  VisualQueryModeller,\n} from './types';\n\nexport interface Props {\n  operation: QueryBuilderOperation;\n  index: number;\n  query: any;\n  datasource: DataSourceApi;\n  queryModeller: VisualQueryModeller;\n  onChange: (index: number, update: QueryBuilderOperation) => void;\n  onRemove: (index: number) => void;\n  onRunQuery: () => void;\n  flash?: boolean;\n  highlight?: boolean;\n}\n\nexport function OperationEditor({\n  operation,\n  index,\n  onRemove,\n  onChange,\n  onRunQuery,\n  queryModeller,\n  query,\n  datasource,\n  flash,\n  highlight,\n}: Props) {\n  const def = queryModeller.getOperationDef(operation.id);\n  const shouldFlash = useFlash(flash);\n  const id = useId();\n\n  const isConflicting =\n    operation.id === LokiOperationId.LabelFilter && isConflictingFilter(operation, query.operations);\n\n  const theme = useTheme2();\n  const styles = getStyles(theme, isConflicting);\n\n  if (!def) {\n    return <span>Operation {operation.id} not found</span>;\n  }\n\n  const onParamValueChanged = (paramIdx: number, value: QueryBuilderOperationParamValue) => {\n    const update: QueryBuilderOperation = { ...operation, params: [...operation.params] };\n    update.params[paramIdx] = value;\n    callParamChangedThenOnChange(def, update, index, paramIdx, onChange);\n  };\n\n  const onAddRestParam = () => {\n    const update: QueryBuilderOperation = { ...operation, params: [...operation.params, ''] };\n    callParamChangedThenOnChange(def, update, index, operation.params.length, onChange);\n  };\n\n  const onRemoveRestParam = (paramIdx: number) => {\n    const update: QueryBuilderOperation = {\n      ...operation,\n      params: [...operation.params.slice(0, paramIdx), ...operation.params.slice(paramIdx + 1)],\n    };\n    callParamChangedThenOnChange(def, update, index, paramIdx, onChange);\n  };\n\n  const operationElements: React.ReactNode[] = [];\n\n  for (let paramIndex = 0; paramIndex < operation.params.length; paramIndex++) {\n    const paramDef = def.params[Math.min(def.params.length - 1, paramIndex)];\n    const Editor = getOperationParamEditor(paramDef);\n\n    operationElements.push(\n      <div className={styles.paramRow} key={`${paramIndex}-1`}>\n        {!paramDef.hideName && (\n          <div className={styles.paramName}>\n            <label htmlFor={getOperationParamId(id, paramIndex)}>{paramDef.name}</label>\n            {paramDef.description && (\n              <Tooltip placement=\"top\" content={paramDef.description} theme=\"info\">\n                <Icon name=\"info-circle\" size=\"sm\" className={styles.infoIcon} />\n              </Tooltip>\n            )}\n          </div>\n        )}\n        <div className={styles.paramValue}>\n          <Stack gap={0.5} direction=\"row\" alignItems=\"center\" wrap={false}>\n            <Editor\n              index={paramIndex}\n              paramDef={paramDef}\n              value={operation.params[paramIndex]}\n              operation={operation}\n              operationId={id}\n              onChange={onParamValueChanged}\n              onRunQuery={onRunQuery}\n              query={query}\n              datasource={datasource}\n            />\n            {paramDef.restParam && (operation.params.length > def.params.length || paramDef.optional) && (\n              <Button\n                data-testid={`operations.${index}.remove-rest-param`}\n                size=\"sm\"\n                fill=\"text\"\n                icon=\"times\"\n                variant=\"secondary\"\n                title={`Remove ${paramDef.name}`}\n                onClick={() => onRemoveRestParam(paramIndex)}\n              />\n            )}\n          </Stack>\n        </div>\n      </div>\n    );\n  }\n\n  // Handle adding button for rest params\n  let restParam: React.ReactNode | undefined;\n  if (def.params.length > 0) {\n    const lastParamDef = def.params[def.params.length - 1];\n    if (lastParamDef.restParam) {\n      restParam = renderAddRestParamButton(lastParamDef, onAddRestParam, index, operation.params.length, styles);\n    }\n  }\n\n  const isInvalid = (isDragging: boolean) => {\n    if (isDragging) {\n      return undefined;\n    }\n\n    return isConflicting ? true : undefined;\n  };\n\n  return (\n    <Draggable draggableId={`operation-${index}`} index={index}>\n      {(provided, snapshot) => (\n        <InlineField\n          error={'You have conflicting label filters'}\n          invalid={isInvalid(snapshot.isDragging)}\n          className={cx(styles.error, styles.cardWrapper)}\n        >\n          <div\n            className={cx(\n              styles.card,\n              (shouldFlash || highlight) && styles.cardHighlight,\n              isConflicting && styles.cardError\n            )}\n            ref={provided.innerRef}\n            {...provided.draggableProps}\n            data-testid={`operations.${index}.wrapper`}\n          >\n            <OperationHeader\n              operation={operation}\n              dragHandleProps={provided.dragHandleProps}\n              def={def}\n              index={index}\n              onChange={onChange}\n              onRemove={onRemove}\n              queryModeller={queryModeller}\n            />\n            <div className={styles.body}>{operationElements}</div>\n            {restParam}\n            {index < query.operations.length - 1 && (\n              <div className={styles.arrow}>\n                <div className={styles.arrowLine} />\n                <div className={styles.arrowArrow} />\n              </div>\n            )}\n          </div>\n        </InlineField>\n      )}\n    </Draggable>\n  );\n}\n\n/**\n * When flash is switched on makes sure it is switched of right away, so we just flash the highlight and then fade\n * out.\n * @param flash\n */\nfunction useFlash(flash?: boolean) {\n  const [keepFlash, setKeepFlash] = useState(true);\n  useEffect(() => {\n    let t: ReturnType<typeof setTimeout>;\n    if (flash) {\n      t = setTimeout(() => {\n        setKeepFlash(false);\n      }, 1000);\n    } else {\n      setKeepFlash(true);\n    }\n\n    return () => clearTimeout(t);\n  }, [flash]);\n\n  return keepFlash && flash;\n}\n\nfunction renderAddRestParamButton(\n  paramDef: QueryBuilderOperationParamDef,\n  onAddRestParam: () => void,\n  operationIndex: number,\n  paramIndex: number,\n  styles: OperationEditorStyles\n) {\n  return (\n    <div className={styles.restParam} key={`${paramIndex}-2`}>\n      <Button\n        size=\"sm\"\n        icon=\"plus\"\n        title={`Add ${paramDef.name}`}\n        variant=\"secondary\"\n        onClick={onAddRestParam}\n        data-testid={`operations.${operationIndex}.add-rest-param`}\n      >\n        {paramDef.name}\n      </Button>\n    </div>\n  );\n}\n\nfunction callParamChangedThenOnChange(\n  def: QueryBuilderOperationDef,\n  operation: QueryBuilderOperation,\n  operationIndex: number,\n  paramIndex: number,\n  onChange: (index: number, update: QueryBuilderOperation) => void\n) {\n  if (def.paramChangedHandler) {\n    onChange(operationIndex, def.paramChangedHandler(paramIndex, operation, def));\n  } else {\n    onChange(operationIndex, operation);\n  }\n}\n\nconst getStyles = (theme: GrafanaTheme2, isConflicting: boolean) => {\n  return {\n    cardWrapper: css({\n      alignItems: 'stretch',\n    }),\n    error: css({\n      marginBottom: theme.spacing(1),\n    }),\n    card: css({\n      background: theme.colors.background.primary,\n      border: `1px solid ${theme.colors.border.medium}`,\n      cursor: 'grab',\n      borderRadius: theme.shape.radius.default,\n      position: 'relative',\n      transition: 'all 0.5s ease-in 0s',\n      height: isConflicting ? 'auto' : '100%',\n    }),\n    cardError: css({\n      boxShadow: `0px 0px 4px 0px ${theme.colors.warning.main}`,\n      border: `1px solid ${theme.colors.warning.main}`,\n    }),\n    cardHighlight: css({\n      boxShadow: `0px 0px 4px 0px ${theme.colors.primary.border}`,\n      border: `1px solid ${theme.colors.primary.border}`,\n    }),\n    infoIcon: css({\n      marginLeft: theme.spacing(0.5),\n      color: theme.colors.text.secondary,\n      ':hover': {\n        color: theme.colors.text.primary,\n      },\n    }),\n    body: css({\n      margin: theme.spacing(1, 1, 0.5, 1),\n      display: 'table',\n    }),\n    paramRow: css({\n      label: 'paramRow',\n      display: 'table-row',\n      verticalAlign: 'middle',\n    }),\n    paramName: css({\n      display: 'table-cell',\n      padding: theme.spacing(0, 1, 0, 0),\n      fontSize: theme.typography.bodySmall.fontSize,\n      fontWeight: theme.typography.fontWeightMedium,\n      verticalAlign: 'middle',\n      height: '32px',\n    }),\n    paramValue: css({\n      label: 'paramValue',\n      display: 'table-cell',\n      verticalAlign: 'middle',\n    }),\n    restParam: css({\n      padding: theme.spacing(0, 1, 1, 1),\n    }),\n    arrow: css({\n      position: 'absolute',\n      top: '0',\n      right: '-18px',\n      display: 'flex',\n    }),\n    arrowLine: css({\n      height: '2px',\n      width: '8px',\n      backgroundColor: theme.colors.border.strong,\n      position: 'relative',\n      top: '14px',\n    }),\n    arrowArrow: css({\n      width: 0,\n      height: 0,\n      borderTop: `5px solid transparent`,\n      borderBottom: `5px solid transparent`,\n      borderLeft: `7px solid ${theme.colors.border.strong}`,\n      position: 'relative',\n      top: '10px',\n    }),\n  };\n};\n\ntype OperationEditorStyles = ReturnType<typeof getStyles>;\n","import { css } from '@emotion/css';\nimport React, { useState } from 'react';\nimport { DragDropContext, Droppable, DropResult } from 'react-beautiful-dnd';\nimport { useMountedState, usePrevious } from 'react-use';\n\nimport { DataSourceApi, GrafanaTheme2 } from '@grafana/data';\nimport { Stack } from '@grafana/experimental';\nimport { Button, Cascader, CascaderOption, useStyles2 } from '@grafana/ui';\n\nimport { OperationEditor } from './OperationEditor';\nimport { QueryBuilderOperation, QueryWithOperations, VisualQueryModeller } from './types';\n\nexport interface Props<T extends QueryWithOperations> {\n  query: T;\n  datasource: DataSourceApi;\n  onChange: (query: T) => void;\n  onRunQuery: () => void;\n  queryModeller: VisualQueryModeller;\n  explainMode?: boolean;\n  highlightedOp?: QueryBuilderOperation;\n}\n\nexport function OperationList<T extends QueryWithOperations>({\n  query,\n  datasource,\n  queryModeller,\n  onChange,\n  onRunQuery,\n  highlightedOp,\n}: Props<T>) {\n  const styles = useStyles2(getStyles);\n  const { operations } = query;\n\n  const opsToHighlight = useOperationsHighlight(operations);\n\n  const [cascaderOpen, setCascaderOpen] = useState(false);\n\n  const onOperationChange = (index: number, update: QueryBuilderOperation) => {\n    const updatedList = [...operations];\n    updatedList.splice(index, 1, update);\n    onChange({ ...query, operations: updatedList });\n  };\n\n  const onRemove = (index: number) => {\n    const updatedList = [...operations.slice(0, index), ...operations.slice(index + 1)];\n    onChange({ ...query, operations: updatedList });\n  };\n\n  const addOptions: CascaderOption[] = queryModeller.getCategories().map((category) => {\n    return {\n      value: category,\n      label: category,\n      items: queryModeller.getOperationsForCategory(category).map((operation) => ({\n        value: operation.id,\n        label: operation.name,\n        isLeaf: true,\n      })),\n    };\n  });\n\n  const onAddOperation = (value: string) => {\n    const operationDef = queryModeller.getOperationDef(value);\n    if (!operationDef) {\n      return;\n    }\n    onChange(operationDef.addOperationHandler(operationDef, query, queryModeller));\n    setCascaderOpen(false);\n  };\n\n  const onDragEnd = (result: DropResult) => {\n    if (!result.destination) {\n      return;\n    }\n\n    const updatedList = [...operations];\n    const element = updatedList[result.source.index];\n    updatedList.splice(result.source.index, 1);\n    updatedList.splice(result.destination.index, 0, element);\n    onChange({ ...query, operations: updatedList });\n  };\n\n  const onCascaderBlur = () => {\n    setCascaderOpen(false);\n  };\n\n  return (\n    <Stack gap={1} direction=\"column\">\n      <Stack gap={1}>\n        {operations.length > 0 && (\n          <DragDropContext onDragEnd={onDragEnd}>\n            <Droppable droppableId=\"sortable-field-mappings\" direction=\"horizontal\">\n              {(provided) => (\n                <div className={styles.operationList} ref={provided.innerRef} {...provided.droppableProps}>\n                  {operations.map((op, index) => {\n                    return (\n                      <OperationEditor\n                        key={op.id + JSON.stringify(op.params) + index}\n                        queryModeller={queryModeller}\n                        index={index}\n                        operation={op}\n                        query={query}\n                        datasource={datasource}\n                        onChange={onOperationChange}\n                        onRemove={onRemove}\n                        onRunQuery={onRunQuery}\n                        flash={opsToHighlight[index]}\n                        highlight={highlightedOp === op}\n                      />\n                    );\n                  })}\n                  {provided.placeholder}\n                </div>\n              )}\n            </Droppable>\n          </DragDropContext>\n        )}\n        <div className={styles.addButton}>\n          {cascaderOpen ? (\n            <Cascader\n              options={addOptions}\n              onSelect={onAddOperation}\n              onBlur={onCascaderBlur}\n              autoFocus={true}\n              alwaysOpen={true}\n              hideActiveLevelLabel={true}\n              placeholder={'Search'}\n            />\n          ) : (\n            <Button icon={'plus'} variant={'secondary'} onClick={() => setCascaderOpen(true)} title={'Add operation'}>\n              Operations\n            </Button>\n          )}\n        </div>\n      </Stack>\n    </Stack>\n  );\n}\n\n/**\n * Returns indexes of operations that should be highlighted. We check the diff of operations added but at the same time\n * we want to highlight operations only after the initial render, so we check for mounted state and calculate the diff\n * only after.\n * @param operations\n */\nfunction useOperationsHighlight(operations: QueryBuilderOperation[]) {\n  const isMounted = useMountedState();\n  const prevOperations = usePrevious(operations);\n\n  if (!isMounted()) {\n    return operations.map(() => false);\n  }\n\n  if (!prevOperations) {\n    return operations.map(() => true);\n  }\n\n  let newOps: boolean[] = [];\n\n  if (prevOperations.length - 1 === operations.length && operations.every((op) => prevOperations.includes(op))) {\n    // In case we remove one op and does not change any ops then don't highlight anything.\n    return operations.map(() => false);\n  }\n  if (prevOperations.length + 1 === operations.length && prevOperations.every((op) => operations.includes(op))) {\n    // If we add a single op just find it and highlight just that.\n    const newOp = operations.find((op) => !prevOperations.includes(op));\n    newOps = operations.map((op) => {\n      return op === newOp;\n    });\n  } else {\n    // Default diff of all ops.\n    newOps = operations.map((op, index) => {\n      return !isSameOp(op.id, prevOperations[index]?.id);\n    });\n  }\n  return newOps;\n}\n\nfunction isSameOp(op1?: string, op2?: string) {\n  return op1 === op2 || `__${op1}_by` === op2 || op1 === `__${op2}_by`;\n}\n\nconst getStyles = (theme: GrafanaTheme2) => {\n  return {\n    heading: css({\n      label: 'heading',\n      fontSize: 12,\n      fontWeight: theme.typography.fontWeightMedium,\n      marginBottom: 0,\n    }),\n    operationList: css({\n      label: 'operationList',\n      display: 'flex',\n      flexWrap: 'wrap',\n      gap: theme.spacing(2),\n    }),\n    addButton: css({\n      label: 'addButton',\n      width: 126,\n      paddingBottom: theme.spacing(1),\n    }),\n  };\n};\n","import { css } from '@emotion/css';\nimport React from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { Stack } from '@grafana/experimental';\nimport { useStyles2 } from '@grafana/ui';\n\ninterface Props {\n  children: React.ReactNode;\n}\n\nexport function OperationsEditorRow({ children }: Props) {\n  const styles = useStyles2(getStyles);\n\n  return (\n    <div className={styles.root}>\n      <Stack gap={1}>{children}</Stack>\n    </div>\n  );\n}\n\nconst getStyles = (theme: GrafanaTheme2) => {\n  return {\n    root: css({\n      padding: theme.spacing(1, 1, 0, 1),\n      backgroundColor: theme.colors.background.secondary,\n      borderRadius: theme.shape.radius.default,\n    }),\n  };\n};\n","import { css } from '@emotion/css';\nimport React, { useState, useEffect } from 'react';\n\nimport { GrafanaTheme2, PanelData, QueryHint } from '@grafana/data';\nimport { reportInteraction } from '@grafana/runtime';\nimport { Button, Tooltip, useStyles2 } from '@grafana/ui';\nimport { LokiDatasource } from 'app/plugins/datasource/loki/datasource';\n\nimport { PrometheusDatasource } from '../../datasource';\n\nimport { LokiAndPromQueryModellerBase, PromLokiVisualQuery } from './LokiAndPromQueryModellerBase';\n\nexport interface Props<T extends PromLokiVisualQuery> {\n  query: T;\n  datasource: PrometheusDatasource | LokiDatasource;\n  queryModeller: LokiAndPromQueryModellerBase;\n  buildVisualQueryFromString: (expr: string) => { query: T };\n  onChange: (update: T) => void;\n  data?: PanelData;\n}\n\nexport const QueryBuilderHints = <T extends PromLokiVisualQuery>({\n  datasource,\n  query: visualQuery,\n  onChange,\n  data,\n  queryModeller,\n  buildVisualQueryFromString,\n}: Props<T>) => {\n  const [hints, setHints] = useState<QueryHint[]>([]);\n  const styles = useStyles2(getStyles);\n\n  useEffect(() => {\n    const query = { expr: queryModeller.renderQuery(visualQuery), refId: '' };\n    // For now show only actionable hints\n    const hints = datasource.getQueryHints(query, data?.series || []).filter((hint) => hint.fix?.action);\n    setHints(hints);\n  }, [datasource, visualQuery, data, queryModeller]);\n\n  return (\n    <>\n      {hints.length > 0 && (\n        <div className={styles.container}>\n          {hints.map((hint) => {\n            return (\n              <Tooltip content={`${hint.label} ${hint.fix?.label}`} key={hint.type}>\n                <Button\n                  onClick={() => {\n                    reportInteraction('grafana_query_builder_hints_clicked', {\n                      hint: hint.type,\n                      datasourceType: datasource.type,\n                    });\n\n                    if (hint?.fix?.action) {\n                      const query = { expr: queryModeller.renderQuery(visualQuery), refId: '' };\n                      const newQuery = datasource.modifyQuery(query, hint.fix.action);\n                      const newVisualQuery = buildVisualQueryFromString(newQuery.expr);\n                      return onChange(newVisualQuery.query);\n                    }\n                  }}\n                  fill=\"outline\"\n                  size=\"sm\"\n                  className={styles.hint}\n                >\n                  hint: {hint.fix?.title || hint.fix?.action?.type.toLowerCase().replace('_', ' ')}\n                </Button>\n              </Tooltip>\n            );\n          })}\n        </div>\n      )}\n    </>\n  );\n};\n\nQueryBuilderHints.displayName = 'QueryBuilderHints';\n\nconst getStyles = (theme: GrafanaTheme2) => {\n  return {\n    container: css`\n      display: flex;\n      align-items: start;\n    `,\n    hint: css`\n      margin-right: ${theme.spacing(1)};\n    `,\n  };\n};\n","import React from 'react';\n\nimport { RadioButtonGroup } from '@grafana/ui';\n\nimport { QueryEditorMode } from './types';\n\nexport interface Props {\n  mode: QueryEditorMode;\n  onChange: (mode: QueryEditorMode) => void;\n}\n\nconst editorModes = [\n  { label: 'Builder', value: QueryEditorMode.Builder },\n  { label: 'Code', value: QueryEditorMode.Code },\n];\n\nexport function QueryEditorModeToggle({ mode, onChange }: Props) {\n  return (\n    <div data-testid={'QueryEditorModeToggle'}>\n      <RadioButtonGroup options={editorModes} size=\"sm\" value={mode} onChange={onChange} />\n    </div>\n  );\n}\n","import { css } from '@emotion/css';\nimport { uniqueId } from 'lodash';\nimport React, { HTMLProps, useRef } from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { Stack } from '@grafana/experimental';\nimport { Switch, useStyles2 } from '@grafana/ui';\n\nexport interface Props extends Omit<HTMLProps<HTMLInputElement>, 'value' | 'ref'> {\n  value?: boolean;\n  label: string;\n}\n\nexport function QueryHeaderSwitch({ label, ...inputProps }: Props) {\n  const dashedLabel = label.replace(' ', '-');\n  const switchIdRef = useRef(uniqueId(`switch-${dashedLabel}`));\n  const styles = useStyles2(getStyles);\n\n  return (\n    <Stack gap={1}>\n      <label htmlFor={switchIdRef.current} className={styles.switchLabel}>\n        {label}\n      </label>\n      <Switch {...inputProps} id={switchIdRef.current} />\n    </Stack>\n  );\n}\n\nconst getStyles = (theme: GrafanaTheme2) => {\n  return {\n    switchLabel: css({\n      color: theme.colors.text.secondary,\n      cursor: 'pointer',\n      fontSize: theme.typography.bodySmall.fontSize,\n      '&:hover': {\n        color: theme.colors.text.primary,\n      },\n    }),\n  };\n};\n","import { css } from '@emotion/css';\nimport React from 'react';\nimport { useToggle } from 'react-use';\n\nimport { getValueFormat, GrafanaTheme2 } from '@grafana/data';\nimport { Stack } from '@grafana/experimental';\nimport { config } from '@grafana/runtime';\nimport { Collapse, Icon, Tooltip, useStyles2 } from '@grafana/ui';\nimport { QueryStats } from 'app/plugins/datasource/loki/types';\n\nexport interface Props {\n  title: string;\n  collapsedInfo: string[];\n  queryStats?: QueryStats | null;\n  children: React.ReactNode;\n}\n\nexport function QueryOptionGroup({ title, children, collapsedInfo, queryStats }: Props) {\n  const [isOpen, toggleOpen] = useToggle(false);\n  const styles = useStyles2(getStyles);\n\n  return (\n    <div className={styles.wrapper}>\n      <Collapse\n        className={styles.collapse}\n        collapsible\n        isOpen={isOpen}\n        onToggle={toggleOpen}\n        label={\n          <Stack gap={0} wrap={false}>\n            <h6 className={styles.title}>{title}</h6>\n            {!isOpen && (\n              <div className={styles.description}>\n                {collapsedInfo.map((x, i) => (\n                  <span key={i}>{x}</span>\n                ))}\n              </div>\n            )}\n          </Stack>\n        }\n      >\n        <div className={styles.body}>{children}</div>\n      </Collapse>\n\n      {queryStats && config.featureToggles.lokiQuerySplitting && (\n        <Tooltip content=\"Note: the query will be split into multiple parts and executed in sequence. Query limits will only apply each individual part.\">\n          <Icon tabIndex={0} name=\"info-circle\" className={styles.tooltip} size=\"sm\" />\n        </Tooltip>\n      )}\n\n      {queryStats && <p className={styles.stats}>{generateQueryStats(queryStats)}</p>}\n    </div>\n  );\n}\n\nconst getStyles = (theme: GrafanaTheme2) => {\n  return {\n    collapse: css({\n      backgroundColor: 'unset',\n      border: 'unset',\n      marginBottom: 0,\n\n      ['> button']: {\n        padding: theme.spacing(0, 1),\n      },\n    }),\n    wrapper: css({\n      width: '100%',\n      display: 'flex',\n      justifyContent: 'space-between',\n      alignItems: 'baseline',\n    }),\n    title: css({\n      flexGrow: 1,\n      overflow: 'hidden',\n      fontSize: theme.typography.bodySmall.fontSize,\n      fontWeight: theme.typography.fontWeightMedium,\n      margin: 0,\n    }),\n    description: css({\n      color: theme.colors.text.secondary,\n      fontSize: theme.typography.bodySmall.fontSize,\n      fontWeight: theme.typography.bodySmall.fontWeight,\n      paddingLeft: theme.spacing(2),\n      gap: theme.spacing(2),\n      display: 'flex',\n    }),\n    body: css({\n      display: 'flex',\n      gap: theme.spacing(2),\n      flexWrap: 'wrap',\n    }),\n    stats: css({\n      margin: '0px',\n      color: theme.colors.text.secondary,\n      fontSize: theme.typography.bodySmall.fontSize,\n    }),\n    tooltip: css({\n      marginRight: theme.spacing(0.25),\n    }),\n  };\n};\n\nconst generateQueryStats = (queryStats: QueryStats) => {\n  if (queryStats.message) {\n    return queryStats.message;\n  }\n\n  return `This query will process approximately ${convertUnits(queryStats)}.`;\n};\n\nconst convertUnits = (queryStats: QueryStats): string => {\n  const { text, suffix } = getValueFormat('bytes')(queryStats.bytes, 1);\n  return text + suffix;\n};\n","import { useCallback, useState } from 'react';\n\nimport store from '../../../../../../core/store';\n\nexport const promQueryEditorExplainKey = 'PrometheusQueryEditorExplainDefault';\nexport const promQueryEditorRawQueryKey = 'PrometheusQueryEditorRawQueryDefault';\nexport const lokiQueryEditorExplainKey = 'LokiQueryEditorExplainDefault';\nexport const lokiQueryEditorRawQueryKey = 'LokiQueryEditorRawQueryDefault';\n\nexport type QueryEditorFlags =\n  | typeof promQueryEditorExplainKey\n  | typeof promQueryEditorRawQueryKey\n  | typeof lokiQueryEditorExplainKey\n  | typeof lokiQueryEditorRawQueryKey;\n\nfunction getFlagValue(key: QueryEditorFlags, defaultValue = false): boolean {\n  const val = store.get(key);\n  return val === undefined ? defaultValue : Boolean(parseInt(val, 10));\n}\n\nfunction setFlagValue(key: QueryEditorFlags, value: boolean) {\n  store.set(key, value ? '1' : '0');\n}\n\ntype UseFlagHookReturnType = { flag: boolean; setFlag: (val: boolean) => void };\n\n/**\n *\n * Use and store value of explain/rawquery switch in local storage.\n * Needs to be a hook with local state to trigger re-renders.\n */\nexport function useFlag(key: QueryEditorFlags, defaultValue = false): UseFlagHookReturnType {\n  const [flag, updateFlag] = useState(getFlagValue(key, defaultValue));\n  const setter = useCallback(\n    (value: boolean) => {\n      setFlagValue(key, value);\n      updateFlag(value);\n    },\n    [key]\n  );\n\n  return { flag, setFlag: setter };\n}\n"],"names":["EditorHeader","children","styles","getStyles","theme","FlexItem","grow","shrink","OperationInfoButton","def","operation","show","setShow","getTooltipProps","setTooltipRef","setTriggerRef","visible","Button","Portal","getOperationDocs","op","OperationHeader","index","onChange","onRemove","queryModeller","dragHandleProps","state","setState","onToggleSwitcher","alternatives","alt","Select","value","newDef","newParams","i","changedOp","getOperationParamEditor","paramDef","SelectInputParamEditor","BoolInputParamEditor","SimpleInputParamEditor","props","AutoSizeInput","evt","Checkbox","operationId","selectOptions","option","valueOption","x","Stack","OperationEditor","onRunQuery","query","datasource","flash","highlight","shouldFlash","useFlash","id","isConflicting","onParamValueChanged","paramIdx","update","callParamChangedThenOnChange","onAddRestParam","onRemoveRestParam","operationElements","paramIndex","Editor","Tooltip","Icon","restParam","lastParamDef","renderAddRestParamButton","isInvalid","isDragging","provided","snapshot","InlineField","keepFlash","setKeepFlash","t","operationIndex","OperationList","highlightedOp","operations","opsToHighlight","useOperationsHighlight","cascaderOpen","setCascaderOpen","onOperationChange","updatedList","addOptions","category","onAddOperation","operationDef","onDragEnd","result","element","onCascaderBlur","Cascader","isMounted","useMountedState","prevOperations","usePrevious","newOps","newOp","isSameOp","op1","op2","OperationsEditorRow","QueryBuilderHints","visualQuery","data","buildVisualQueryFromString","hints","setHints","hint","newQuery","newVisualQuery","editorModes","QueryEditorModeToggle","mode","QueryHeaderSwitch","label","inputProps","dashedLabel","switchIdRef","QueryOptionGroup","title","collapsedInfo","queryStats","isOpen","toggleOpen","generateQueryStats","convertUnits","text","suffix","promQueryEditorExplainKey","promQueryEditorRawQueryKey","lokiQueryEditorExplainKey","lokiQueryEditorRawQueryKey","getFlagValue","key","defaultValue","val","setFlagValue","useFlag","flag","updateFlag","setter"],"sourceRoot":""}