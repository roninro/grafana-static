"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[3778],{54446:(A,D,e)=>{e.r(D),e.d(D,{BrowseFolderLibraryPanelsPage:()=>v,default:()=>P});var a=e(39953),O=e(13253),d=e(34112),t=e(82744),g=e(13880),n=e(9791),o=e(46347);function v({match:h}){const{uid:r}=h.params,{data:s}=(0,o.t4)(r),[_,u]=(0,a.useState)(void 0),[m]=(0,o.vN)(),l=(0,a.useMemo)(()=>{if(!s)return;const E=(0,t.B1)(s),M=(0,t.AZ)(s.uid),i=E.children?.find(C=>C.id===M);return i&&(i.active=!0),E},[s]),c=r?async E=>{if(s){const M=await m({...s,title:E});if("error"in M)throw M.error}}:void 0;return a.createElement(O.T,{navId:"dashboards/browse",pageNav:l,onEditTitle:c,actions:a.createElement(a.Fragment,null,s&&a.createElement(d.A,{folder:s}))},a.createElement(O.T.Contents,null,a.createElement(g.N,{onClick:u,currentFolderUID:r,showSecondaryActions:!0,showSort:!0,showPanelFilter:!0}),_?a.createElement(n.b,{onDismiss:()=>u(void 0),libraryPanel:_}):null))}const P=v},62719:(A,D,e)=>{e.d(D,{p:()=>h});var a=e(39953),O=e(30623),d=e(32688),t=e(32840),g=e(98632),n=e(33155),o=e(62679),v=e(46347),P=e(83408);const h=({onConfirm:r,onDismiss:s,selectedItems:_,...u})=>{const{data:m}=(0,v.zs)(_),l=!d.config.featureToggles.nestedFolders&&m&&(m.alertRule||m.libraryPanel),[c,E]=(0,a.useState)(!1),M=async()=>{E(!0);try{await r(),E(!1),s()}catch{E(!1)}};return a.createElement(t.s,{body:a.createElement(a.Fragment,null,a.createElement(g.x,{element:"p"},a.createElement(o.cC,{i18nKey:"browse-dashboards.action.delete-modal-text"},"This action will delete the following content:")),a.createElement(P.X,{selectedItems:_}),a.createElement(O.T,{v:2})),description:a.createElement(a.Fragment,null,l?a.createElement(n.b,{severity:"warning",title:(0,o.t)("browse-dashboards.action.delete-modal-invalid-title","Cannot delete folder")},a.createElement(o.cC,{i18nKey:"browse-dashboards.action.delete-modal-invalid-text"},"One or more folders contain library panels or alert rules. Delete these first in order to proceed.")):null),confirmationText:"Delete",confirmText:c?(0,o.t)("browse-dashboards.action.deleting","Deleting..."):(0,o.t)("browse-dashboards.action.delete-button","Delete"),onDismiss:s,onConfirm:M,title:(0,o.t)("browse-dashboards.action.delete-modal-title","Delete"),...u})}},44081:(A,D,e)=>{e.d(D,{_:()=>r});var a=e(39953),O=e(30623),d=e(73075),t=e(33155),g=e(98632),n=e(96227),o=e(4919),v=e(15296),P=e(62679),h=e(83408);const r=({onConfirm:s,onDismiss:_,selectedItems:u,...m})=>{const[l,c]=(0,a.useState)(),[E,M]=(0,a.useState)(!1),i=Object.keys(u.folder).filter(I=>u.folder[I]),C=async()=>{if(l!==void 0){M(!0);try{await s(l),M(!1),_()}catch{M(!1)}}};return a.createElement(d.u,{title:(0,P.t)("browse-dashboards.action.move-modal-title","Move"),onDismiss:_,...m},i.length>0&&a.createElement(t.b,{severity:"info",title:(0,P.t)("browse-dashboards.action.move-modal-alert","Moving this item may change its permissions.")}),a.createElement(g.x,{element:"p"},a.createElement(P.cC,{i18nKey:"browse-dashboards.action.move-modal-text"},"This action will move the following content:")),a.createElement(h.X,{selectedItems:u}),a.createElement(O.T,{v:3}),a.createElement(n.g,{label:(0,P.t)("browse-dashboards.action.move-modal-field-label","Folder name")},a.createElement(v.E,{value:l,excludeUIDs:i,onChange:c})),a.createElement(d.u.ButtonRow,null,a.createElement(o.zx,{onClick:_,variant:"secondary",fill:"outline"},a.createElement(P.cC,{i18nKey:"browse-dashboards.action.cancel-button"},"Cancel")),a.createElement(o.zx,{disabled:l===void 0||E,onClick:C,variant:"primary"},E?(0,P.t)("browse-dashboards.action.moving","Moving..."):(0,P.t)("browse-dashboards.action.move-button","Move"))))}},34112:(A,D,e)=>{e.d(D,{A:()=>M});var a=e(39953),O=e(32688),d=e(72639),t=e(13601),g=e(13767),n=e(85001),o=e(58047),v=e(4919),P=e(12190),h=e(87722),r=e(88206),s=e(21308),_=e(62679),u=e(73431),m=e(46347),l=e(33188),c=e(62719),E=e(44081);function M({folder:i}){const[C,I]=(0,a.useState)(!1),[L,B]=(0,a.useState)(!1),[b]=(0,m.OH)(),[U]=(0,m.yC)(),{canEditFolders:R,canDeleteFolders:f,canViewPermissions:K,canSetPermissions:y}=(0,l.a)(i),W=O.config.featureToggles.nestedFolders&&R,p=async T=>{await b({folder:i,destinationUID:T}),(0,d.ff)("grafana_manage_dashboards_item_moved",{item_counts:{folder:1,dashboard:0},source:"folder_actions"})},F=async()=>{await U(i),(0,d.ff)("grafana_manage_dashboards_item_deleted",{item_counts:{folder:1,dashboard:0},source:"folder_actions"});const{parents:T}=i,$=T&&T.length?T[T.length-1].url:"/dashboards";t.E1.push($)},S=()=>{s.h$.publish(new u.Dn({component:E._,props:{selectedItems:{folder:{[i.uid]:!0},dashboard:{},panel:{},$all:!1},onConfirm:p}}))},x=()=>{s.h$.publish(new u.Dn({component:c.p,props:{selectedItems:{folder:{[i.uid]:!0},dashboard:{},panel:{},$all:!1},onConfirm:F}}))},z=(0,_.t)("browse-dashboards.folder-actions-button.manage-permissions","Manage permissions"),w=(0,_.t)("browse-dashboards.folder-actions-button.move","Move"),V=(0,_.t)("browse-dashboards.folder-actions-button.delete","Delete"),N=a.createElement(g.v,null,K&&a.createElement(n.s,{onClick:()=>B(!0),label:z}),W&&a.createElement(n.s,{onClick:S,label:w}),f&&a.createElement(n.s,{destructive:!0,onClick:x,label:V}));return!K&&!W&&!f?null:a.createElement(a.Fragment,null,a.createElement(o.L,{overlay:N,onVisibleChange:I},a.createElement(v.zx,{variant:"secondary"},a.createElement(_.cC,{i18nKey:"browse-dashboards.folder-actions-button.folder-actions"},"Folder actions"),a.createElement(P.J,{name:C?"angle-up":"angle-down"}))),L&&a.createElement(h.d,{title:(0,_.t)("browse-dashboards.action.manage-permissions-button","Manage permissions"),subtitle:i.title,onClose:()=>B(!1),size:"md"},a.createElement(r.P,{resource:"folders",resourceId:i.uid,canSetPermissions:y})))}},33188:(A,D,e)=>{e.d(D,{a:()=>g});var a=e(32688),O=e(21308),d=e(57721);function t(n,o){return o?O.Vt.hasPermissionInMetadata(n,o):O.Vt.hasPermission(n)}function g(n){const o=t(d.AccessControlAction.DashboardsCreate,n),v=!!((!n||a.config.featureToggles.nestedFolders)&&t(d.AccessControlAction.FoldersCreate)),P=t(d.AccessControlAction.FoldersDelete,n),h=t(d.AccessControlAction.DashboardsWrite,n),r=t(d.AccessControlAction.FoldersWrite,n),s=t(d.AccessControlAction.FoldersPermissionsWrite,n),_=t(d.AccessControlAction.FoldersPermissionsRead,n);return{canCreateDashboards:o,canCreateFolders:v,canDeleteFolders:P,canEditDashboards:h,canEditFolders:r,canSetPermissions:s,canViewPermissions:_}}},885:(A,D,e)=>{e.r(D),e.d(D,{FolderLibraryPanelsPage:()=>_,default:()=>u});var a=e(39953),O=e(89772),d=e(20653),t=e(13253),g=e(45015),n=e(13880),o=e(9791),v=e(83600),P=e(82744);const h=(m,l)=>{const c=l.match.params.uid;return{pageNav:(0,g.ht)(m.navIndex,`folder-library-panels-${c}`,(0,P._l)(1)),folderUid:c}},r={getFolderByUid:v.Pb},s=(0,O.connect)(h,r);function _({pageNav:m,getFolderByUid:l,folderUid:c}){const{loading:E}=(0,d.Z)(async()=>await l(c),[l,c]),[M,i]=(0,a.useState)(void 0);return a.createElement(t.T,{navId:"dashboards/browse",pageNav:m.main},a.createElement(t.T.Contents,{isLoading:E},a.createElement(n.N,{onClick:i,currentFolderUID:c,showSecondaryActions:!0,showSort:!0,showPanelFilter:!0}),M?a.createElement(o.b,{onDismiss:()=>i(void 0),libraryPanel:M}):null))}const u=s(_)},9791:(A,D,e)=>{e.d(D,{b:()=>_});var a=e(41407),O=e(97368),d=e.n(O),t=e(39953),g=e(69307),n=e(13601),o=e(82803),v=e(73075),P=e(9558),h=e(4919),r=e(62679),s=e(64840);function _({libraryPanel:l,onDismiss:c}){const E=(0,o.wW)(m),[M,i]=(0,t.useState)(!1),[C,I]=(0,t.useState)(0),[L,B]=(0,t.useState)(void 0);(0,t.useEffect)(()=>{(async()=>{const K=await(0,s.Ef)(l.uid);I(K.length)})()},[l.uid]);const b=(0,t.useCallback)(f=>u(l.uid,f,i),[l.uid]),U=(0,t.useMemo)(()=>d()(b,300,{leading:!0}),[b]),R=f=>{f.preventDefault(),n.E1.push(g.Cj.renderUrl(`/d/${L?.value?.uid}`,{}))};return t.createElement(v.u,{title:(0,r.t)("library-panels.modal.title","View panel in dashboard"),onDismiss:c,onClickBackdrop:c,isOpen:!0},t.createElement("div",{className:E.container},C===0?t.createElement("span",null,t.createElement(r.cC,{i18nKey:"library-panels.modal.panel-not-linked"},"Panel is not linked to a dashboard. Add the panel to a dashboard and retry.")):null,C>0?t.createElement(t.Fragment,null,t.createElement("p",null,t.createElement(r.cC,{i18nKey:"library-panels.modal.body",count:C},"This panel is being used in ",{count:C}," dashboard. Please choose which dashboard to view the panel in:")),t.createElement(P.qb,{isClearable:!0,isLoading:M,defaultOptions:!0,loadOptions:U,onChange:B,placeholder:(0,r.t)("library-panels.modal.select-placeholder","Start typing to search for dashboard"),noOptionsMessage:(0,r.t)("library-panels.modal.select-no-options-message","No dashboards found")})):null),t.createElement(v.u.ButtonRow,null,t.createElement(h.zx,{variant:"secondary",onClick:c,fill:"outline"},t.createElement(r.cC,{i18nKey:"library-panels.modal.button-cancel"},"Cancel")),t.createElement(h.zx,{onClick:R,disabled:!L},L?(0,r.t)("library-panels.modal.button-view-panel1","View panel in {{label}}...",{label:L?.label}):(0,r.t)("library-panels.modal.button-view-panel2","View panel in dashboard..."))))}async function u(l,c,E){E(!0);const i=(await(0,s.E8)(l)).filter(C=>C.title.toLowerCase().includes(c.toLowerCase())).map(C=>({label:C.title,value:C}));return E(!1),i}function m(l){return{container:(0,a.css)``}}}}]);

//# sourceMappingURL=FolderLibraryPanelsPage.b5aef058c0dff5f4ca9e.js.map