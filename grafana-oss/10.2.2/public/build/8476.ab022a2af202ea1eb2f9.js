"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[8476],{40520:(k,F,e)=>{e.d(F,{N:()=>g});var x=e(82909),t=e(66654),O=e(86981),L=e(89591),R=e(69330),B=e(36085),U=e(52343);const K="hideSeriesFrom",G=(0,x.Y4)(K);function g(u,f,i,p){const{overrides:l}=i,d=u,S=l.findIndex(G);if(S<0){if(f===U.R.ToggleSelection){const r=I([d,...N(l,p)]);return{...i,overrides:[...i.overrides,r]}}const E=W(p,d),n=I(E);return{...i,overrides:[...i.overrides,n]}}const y=Array.from(l),[a]=y.splice(S,1);if(f===U.R.ToggleSelection){let E=D(a);const n=N(y,p);if(n.length>0&&(E=E.filter(c=>n.indexOf(c)<0)),E[0]===d&&E.length===1)return{...i,overrides:y};const r=I([d,...n]);return{...i,overrides:[...y,r]}}const M=z(a,d);return Y(M,p)?{...i,overrides:y}:{...i,overrides:[...y,M]}}function I(u,f=t.Ys.exclude,i){return i=i??{id:"custom.hideFrom",value:{viz:!0,legend:!1,tooltip:!1}},{__systemRef:K,matcher:{id:O.mi.byNames,options:{mode:f,names:u,prefix:f===t.Ys.exclude?"All except:":void 0,readOnly:!0}},properties:[{...i,value:{viz:!0,legend:!1,tooltip:!1}}]}}const z=(u,f,i=t.Ys.exclude)=>{const p=u.properties.find(S=>S.id==="custom.hideFrom"),l=D(u),d=l.findIndex(S=>S===f);return d<0?l.push(f):l.splice(d,1),I(l,i,p)},D=u=>{const f=u.matcher.options?.names;return Array.isArray(f)?[...f]:[]},Y=(u,f)=>D(u).length===W(f).length,W=(u,f)=>{const i=new Set;for(const p of u)for(const l of p.fields){if(l.type!==L.fS.number)continue;const d=(0,R.CZ)(l,p,u);d!==f&&i.add(d)}return Array.from(i)},N=(u,f)=>{let i=[];for(const p of u){const l=p.properties.find(d=>d.id==="custom.hideFrom");if(l!==void 0&&l.value?.legend===!0){const S=B.Ls.get(p.matcher.id).get(p.matcher.options);for(const y of f)for(const a of y.fields){if(a.type!==L.fS.number)continue;const M=(0,R.CZ)(a,y,f);S(a,y,f)&&i.push(M)}}}return i}},61344:(k,F,e)=>{e.d(F,{y:()=>E});var x=e(86832),t=e(39953),O=e(92403),L=e(51761),R=e(97898),B=e(52716),U=e(69330),K=e(40793),G=e(51103),g=e(34547),I=e(82803),z=e(31276),D=e(71237),Y=e(40520),W=e(46617),N=e(35422);function u(n,r,c){return(0,N.Uy)(n,o=>{o.defaults.custom===void 0&&(o.defaults.custom={}),o.defaults.max=c;const{custom:s}=o.defaults;switch(s.stacking===void 0&&(s.stacking={group:"A"}),r){case"lines":s.drawStyle=g.l8.Line,s.stacking.mode=g.o0.None,s.fillOpacity=0;break;case"bars":s.drawStyle=g.l8.Bars,s.stacking.mode=g.o0.None,s.fillOpacity=100;break;case"points":s.drawStyle=g.l8.Points,s.stacking.mode=g.o0.None,s.fillOpacity=0;break;case"stacked_lines":s.drawStyle=g.l8.Line,s.stacking.mode=g.o0.Normal,s.fillOpacity=100,s.axisSoftMin=0;break;case"stacked_bars":s.drawStyle=g.l8.Bars,s.stacking.mode=g.o0.Normal,s.fillOpacity=100,s.axisSoftMin=0;break;default:{const C=r;throw new Error(`Invalid graph-style: ${C}`)}}})}function f(n,r,c){return(0,N.Uy)(n,o=>{o.defaults.thresholds=c,o.defaults.custom=o.defaults.custom??{},o.defaults.custom.thresholdsStyle=r})}var i=function(n){return(n+1)%1e6};function p(){var n=(0,t.useReducer)(i,0),r=n[1];return r}function l(n,r){return typeof n=="function"?n.length?n(r):n():n}function d(n){var r=(0,t.useRef)(l(n)),c=p();return(0,t.useMemo)(function(){return[function(){return r.current},function(o){r.current=l(o,r.current),c()}]},[])}function S(n,r,c){n===void 0&&(n=0),r===void 0&&(r=null),c===void 0&&(c=null);var o=l(n);typeof o!="number"&&console.error("initialValue has to be a number, got "+typeof n),typeof c=="number"?o=Math.max(o,c):c!==null&&console.error("min has to be a number, got "+typeof c),typeof r=="number"?o=Math.min(o,r):r!==null&&console.error("max has to be a number, got "+typeof r);var s=d(o),C=s[0],H=s[1];return[C(),(0,t.useMemo)(function(){var T=function(m){var v=C(),h=l(m,v);v!==h&&(typeof c=="number"&&(h=Math.max(h,c)),typeof r=="number"&&(h=Math.min(h,r)),v!==h&&H(h))};return{get:C,set:T,inc:function(m){m===void 0&&(m=1);var v=l(m,C());typeof v!="number"&&console.error("delta has to be a number or function returning a number, got "+typeof v),T(function(h){return h+v})},dec:function(m){m===void 0&&(m=1);var v=l(m,C());typeof v!="number"&&console.error("delta has to be a number or function returning a number, got "+typeof v),T(function(h){return h-v})},reset:function(m){m===void 0&&(m=o);var v=l(m,C());typeof v!="number"&&console.error("value has to be a number or function returning a number, got "+typeof v),o=v,T(v)}}},[o,c,r])]}var y=e(7763),a=e(99977);function M(n){const[r,{inc:c}]=S(1),o=(0,y.Z)(n);return(0,t.useMemo)(()=>{o&&!(0,a.nl)(n,o,a.Ch)&&c()},[n,o,c]),r}function E({data:n,height:r,width:c,timeZone:o,absoluteRange:s,onChangeTime:C,loadingState:H,annotations:T,onHiddenSeriesChanged:m,splitOpenFn:v,graphStyle:h,tooltipDisplayMode:X=g.f3.Single,anchorToZero:j=!1,yAxisMaximum:b,thresholdsConfig:Q,thresholdsStyle:$,eventBus:q}){const A=(0,I.l4)(),J=(0,t.useMemo)(()=>({from:(0,O.CQ)(s.from),to:(0,O.CQ)(s.to),raw:{from:(0,O.CQ)(s.from),to:(0,O.CQ)(s.to)}}),[s.from,s.to]),ee=(0,t.useMemo)(()=>(0,L.j)((0,D.F)(D.r),"Explore"),[]),[_,ne]=(0,t.useState)({defaults:{min:j?0:void 0,max:b||void 0,unit:"short",color:{mode:R.S.PaletteClassic},custom:{drawStyle:g.l8.Line,fillOpacity:0,pointSize:5}},overrides:[]}),te=(0,t.useMemo)(()=>{const P=u(_,h,b);return f(P,$,Q)},[_,h,b,Q,$]),V=(0,W.v)(v,J),Z=(0,t.useMemo)(()=>(0,B.SM)({fieldConfig:te,data:n,timeZone:o,replaceVariables:P=>P,theme:A,fieldConfigRegistry:ee,dataLinkPostProcessor:V}),[ee,n,o,A,te,V]),oe=(0,t.useMemo)(()=>(0,B.SM)({fieldConfig:{defaults:{},overrides:[]},data:T,timeZone:o,replaceVariables:P=>P,theme:A,dataLinkPostProcessor:V}),[T,o,A,V]),re=M(Z);(0,t.useEffect)(()=>{if(m){const P=[];Z.forEach(w=>{w.fields.map(ie=>ie.config?.custom?.hideFrom?.viz).every(x.identity)&&P.push((0,U.nf)(w))}),m(P)}},[Z,m]);const se={eventsScope:"explore",eventBus:q,sync:()=>K.m.Crosshair,onToggleSeriesVisibility(P,w){ne((0,Y.N)(P,w,_,n))},dataLinkPostProcessor:V},ae=(0,t.useMemo)(()=>({tooltip:{mode:X,sort:g.As.None},legend:{displayMode:g.jK.List,showLegend:!0,placement:"bottom",calcs:[]}}),[X]);return t.createElement(z._w,{value:se},t.createElement(G.$,{data:{series:Z,timeRange:J,state:H,annotations:oe,structureRev:re},pluginId:"timeseries",title:"",width:c,height:r,onChangeTimeRange:C,timeZone:o,options:ae}))}},38476:(k,F,e)=>{e.d(F,{F:()=>S});var x=e(41407),t=e(39953),O=e(948),L=e(82803),R=e(4185),B=e(12190),U=e(69865),K=e(4919),G=e(62679),g=e(47203),I=e(61344),z=e(20454),D=e(57721);const Y=D.EXPLORE_GRAPH_STYLES.map(a=>({value:a,label:a[0].toUpperCase()+a.slice(1).replace(/_/," ")}));function W(a){const{graphStyle:M,onChangeGraphStyle:E}=a;return t.createElement(z.S,{size:"sm",options:Y,value:M,onChange:E})}var N=e(23062);const u="grafana.explore.style.graph",f=a=>{store.set(u,a)},i=()=>l(N.Z.get(u)),p="lines",l=a=>D.EXPLORE_GRAPH_STYLES.find(E=>E===a)??p,d=20,S=({data:a,eventBus:M,height:E,width:n,absoluteRange:r,timeZone:c,annotations:o,onChangeTime:s,splitOpenFn:C,thresholdsConfig:H,thresholdsStyle:T,loadingState:m,statusMessage:v})=>{const[h,X]=(0,O.Z)(!1),[j,b]=(0,t.useState)(i),Q=(0,L.wW)(y),$=(0,t.useCallback)(A=>{(0,g.FG)(A),b(A)},[]),q=(0,t.useMemo)(()=>h?a:a.slice(0,d),[a,h]);return t.createElement(R.fm,{title:(0,G.t)("graph.container.title","Graph"),titleItems:[!h&&d<a.length&&t.createElement("div",{key:"disclaimer",className:Q.timeSeriesDisclaimer},t.createElement("span",{className:Q.warningMessage},t.createElement(B.J,{name:"exclamation-triangle","aria-hidden":"true"}),t.createElement(G.cC,{i18nKey:"graph.container.show-only-series"},"Showing only ",{MAX_NUMBER_OF_TIME_SERIES:d}," series")),t.createElement(U.u,{content:(0,G.t)("graph.container.content","Rendering too many series in a single panel may impact performance and make data harder to read. Consider refining your queries.")},t.createElement(K.zx,{variant:"secondary",size:"sm",onClick:X},t.createElement(G.cC,{i18nKey:"graph.container.show-all-series"},"Show all ",{length:a.length}))))].filter(Boolean),width:n,height:E,loadingState:m,statusMessage:v,actions:t.createElement(W,{graphStyle:j,onChangeGraphStyle:$})},(A,J)=>t.createElement(I.y,{graphStyle:j,data:q,height:J,width:A,absoluteRange:r,onChangeTime:s,timeZone:c,annotations:o,splitOpenFn:C,loadingState:m,thresholdsConfig:H,thresholdsStyle:T,eventBus:M}))},y=a=>({timeSeriesDisclaimer:(0,x.css)({label:"time-series-disclaimer",display:"flex",alignItems:"center",gap:a.spacing(1)}),warningMessage:(0,x.css)({display:"flex",alignItems:"center",gap:a.spacing(.5),color:a.colors.warning.main,fontSize:a.typography.bodySmall.fontSize})})},46617:(k,F,e)=>{e.d(F,{v:()=>O});var x=e(39953),t=e(42512);const O=(L,R)=>(0,x.useMemo)(()=>(0,t.qQ)(L,R),[L,R])}}]);

//# sourceMappingURL=8476.ab022a2af202ea1eb2f9.js.map