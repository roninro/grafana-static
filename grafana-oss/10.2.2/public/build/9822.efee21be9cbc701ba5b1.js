"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[9822],{86860:(v,l,e)=>{e.d(l,{u:()=>m});var t=e(41407),a=e(39953),o=e(82803),_=e(33155),n=e(47858),r=e(37546),E=e(95712);function m({currentAlertmanager:i}){const P=(0,o.wW)(c),{useGetAlertmanagerChoiceStatusQuery:g}=r.alertmanagerApi,{currentData:d}=g(),T=i===E.GC;if(!(d?.alertmanagersChoice&&[n.TE.External,n.TE.All].includes(d?.alertmanagersChoice))||!T)return null;const A=d.numExternalAlertmanagers>0;return d.alertmanagersChoice===n.TE.External?a.createElement(_.b,{title:"Grafana alerts are not delivered to Grafana Alertmanager"},"Grafana is configured to send alerts to external Alertmanagers only. Changing Grafana Alertmanager configuration will not affect delivery of your alerts.",a.createElement("div",{className:P.adminHint},"To change your Alertmanager setup, go to the Alerting Admin page. If you do not have access, contact your Administrator.")):d.alertmanagersChoice===n.TE.All&&A?a.createElement(_.b,{title:"You have additional Alertmanagers to configure",severity:"warning"},"Ensure you make configuration changes in the correct Alertmanagers; both internal and external. Changing one will not affect the others.",a.createElement("div",{className:P.adminHint},"To change your Alertmanager setup, go to the Alerting Admin page. If you do not have access, contact your Administrator.")):null}const c=i=>({adminHint:(0,t.css)`
    font-size: ${i.typography.bodySmall.fontSize};
    font-weight: ${i.typography.bodySmall.fontWeight};
  `})},29822:(v,l,e)=>{e.r(l),e.d(l,{default:()=>L});var t=e(39953),a=e(53721),o=e(33155),_=e(84766),n=e(57721),r=e(72401),E=e(26544),m=e(328),c=e(79493),i=e(95712),P=e(86860),g=e(51858),d=e(50221),T=e(13747),U=e(65449),A=e(43005),K=e(56925),f=e(49833);const L=()=>{const{selectedAlertmanager:s}=(0,m.ZA)(),u=(0,n.useDispatch)(),{currentData:D,isLoading:W,error:I}=(0,r.W)(s),C=(0,E._)(O=>O.grafanaNotifiers);return(0,t.useEffect)(()=>{s===i.GC&&!(C.result||C.loading||C.error)&&u((0,c.Vj)())},[s,u,C]),s?t.createElement(t.Fragment,null,I&&!W&&t.createElement(o.b,{severity:"error",title:"Error loading Alertmanager config"},I.message||"Unknown error."),t.createElement(P.u,{currentAlertmanager:s}),W&&!D&&t.createElement(_.u,{text:"loading configuration..."}),D&&!I&&t.createElement(a.rs,null,t.createElement(a.AW,{exact:!0,path:"/alerting/notifications"},t.createElement(f.Gb,{config:D,alertManagerName:s})),t.createElement(a.AW,{exact:!0,path:"/alerting/notifications/templates/new"},t.createElement(K.T,{config:D,alertManagerSourceName:s})),t.createElement(a.AW,{exact:!0,path:"/alerting/notifications/templates/:name/duplicate"},({match:O})=>O?.params.name&&t.createElement(g.K,{alertManagerSourceName:s,config:D,templateName:decodeURIComponent(O?.params.name)})),t.createElement(a.AW,{exact:!0,path:"/alerting/notifications/templates/:name/edit"},({match:O})=>O?.params.name&&t.createElement(T.C,{alertManagerSourceName:s,config:D,templateName:decodeURIComponent(O?.params.name)})),t.createElement(a.AW,{exact:!0,path:"/alerting/notifications/receivers/new"},t.createElement(A.s,{config:D,alertManagerSourceName:s})),t.createElement(a.AW,{exact:!0,path:"/alerting/notifications/receivers/:name/edit"},({match:O})=>O?.params.name&&t.createElement(d.e,{alertManagerSourceName:s,config:D,receiverName:decodeURIComponent(O?.params.name)})),t.createElement(a.AW,{exact:!0,path:"/alerting/notifications/global-config"},t.createElement(U.e,{config:D,alertManagerSourceName:s})))):null}},51858:(v,l,e)=>{e.d(l,{K:()=>r});var t=e(39953),a=e(33155),o=e(31559),_=e(8822),n=e(9853);const r=({config:E,templateName:m,alertManagerSourceName:c})=>{const i=E.template_files?.[m];if(!i)return t.createElement(a.b,{severity:"error",title:"Template not found"},"Sorry, this template does not seem to exists.");const P=(0,o.G)(m,Object.keys(E.template_files));return t.createElement(n.OZ,{alertManagerSourceName:c,config:E,existing:{name:P,content:(0,_.M)(i)}})}},50221:(v,l,e)=>{e.d(l,{e:()=>r});var t=e(39953),a=e(33155),o=e(95712),_=e(37472),n=e(87035);const r=({config:E,receiverName:m,alertManagerSourceName:c})=>{const i=E.alertmanager_config.receivers?.find(({name:P})=>P===m);return i?c===o.GC?t.createElement(n.p,{config:E,alertManagerSourceName:c,existing:i}):t.createElement(_.m,{config:E,alertManagerSourceName:c,existing:i}):t.createElement(a.b,{severity:"error",title:"Receiver not found"},"Sorry, this receiver does not seem to exist.")}},13747:(v,l,e)=>{e.d(l,{C:()=>_});var t=e(39953),a=e(33155),o=e(9853);const _=({config:n,templateName:r,alertManagerSourceName:E})=>{const m=n.template_files?.[r],c=n.template_file_provenances?.[r];return m?t.createElement(o.OZ,{alertManagerSourceName:E,config:n,existing:{name:r,content:m},provenance:c}):t.createElement(a.b,{severity:"error",title:"Template not found"},"Sorry, this template does not seem to exists.")}},65449:(v,l,e)=>{e.d(l,{e:()=>K});var t=e(39953),a=e(14058),o=e(33155),_=e(12223),n=e(4919),r=e(9661),E=e(57721),m=e(26544),c=e(79493),i=e(27732),P=e(95712),g=e(76716),d=e(3835),T=e(57675),U=e(45266);const A={smtp_require_tls:!0},K=({config:f,alertManagerSourceName:R})=>{const L=(0,E.useDispatch)();(0,r.x)(M=>M.unifiedAlerting.saveAMConfig=T.oq);const{loading:s,error:u}=(0,m._)(M=>M.saveAMConfig),D=(0,P.RY)(R),W=(0,a.cI)({defaultValues:JSON.parse(JSON.stringify({...A,...f.alertmanager_config.global??{}}))}),{handleSubmit:I,formState:{errors:C}}=W,O=M=>{L((0,c.mM)({newConfig:{...f,alertmanager_config:{...f.alertmanager_config,global:(0,d.oP)(M)}},oldConfig:f,alertManagerSourceName:R,successMessage:"Global config updated.",redirectPath:(0,g.eQ)("/alerting/notifications",R)}))};return t.createElement(a.RV,{...W},t.createElement("form",{onSubmit:I(O)},u&&t.createElement(o.b,{severity:"error",title:"Error saving receiver"},u.message||String(u)),i.g.map(M=>t.createElement(U.t,{readOnly:D,defaultValue:A[M.propertyName],key:M.propertyName,option:M,error:C[M.propertyName],pathPrefix:""})),t.createElement("div",null,t.createElement(_.Lh,null,!D&&t.createElement(t.Fragment,null,s&&t.createElement(n.zx,{disabled:!0,icon:"fa fa-spinner",variant:"primary"},"Saving..."),!s&&t.createElement(n.zx,{type:"submit"},"Save global config")),t.createElement(n.Qj,{disabled:s,fill:"outline",variant:"secondary",href:(0,g.eQ)("alerting/notifications",R)},"Cancel")))))}},43005:(v,l,e)=>{e.d(l,{s:()=>n});var t=e(39953),a=e(95712),o=e(37472),_=e(87035);const n=({alertManagerSourceName:r,config:E})=>r===a.GC?t.createElement(_.p,{alertManagerSourceName:r,config:E}):t.createElement(o.m,{alertManagerSourceName:r,config:E})},56925:(v,l,e)=>{e.d(l,{T:()=>o});var t=e(39953),a=e(9853);const o=({config:_,alertManagerSourceName:n})=>t.createElement(a.OZ,{config:_,alertManagerSourceName:n})},31559:(v,l,e)=>{e.d(l,{G:()=>t});function t(a,o){const _=a.replace(/\(copy( [0-9]+)?\)$/,"").trim();let n=`${_} (copy)`;for(let r=2;o.includes(n);r++)n=`${_} (copy ${r})`;return n}}}]);

//# sourceMappingURL=9822.efee21be9cbc701ba5b1.js.map